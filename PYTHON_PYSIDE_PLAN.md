# OC_RAG PySide 데스크톱 버전 개발 플랜

## 📋 프로젝트 개요
- **목표**: Streamlit 기반 RAG 시스템을 PySide6 기반 데스크톱 애플리케이션으로 포팅
- **용도**: 로컬 테스트 및 배포용 데스크톱 앱
- **장점**: 더 빠른 실행, 네이티브 UI, 오프라인 사용 가능

## 🏗️ 아키텍처 설계

### 1. 프로젝트 구조
```
RAG_for_OC_251014/
├── app.py                    # Streamlit 메인 앱 (기존)
├── desktop_app.py           # PySide6 메인 앱 (신규)
├── config.py                # 설정 관리 (공통)
├── requirements.txt          # 의존성 (PySide6 추가)
├── utils/                   # 공통 유틸리티
│   ├── rag_chain.py         # RAG 체인 (공통)
│   ├── vector_store.py      # 벡터 스토어 (공통)
│   ├── document_processor.py # 문서 처리 (공통)
│   ├── reranker.py          # Re-ranker (공통)
│   ├── request_llm.py       # Request LLM (공통)
│   └── chat_history.py      # 대화 이력 (공통)
├── ui/                      # PySide6 UI 컴포넌트 (신규)
│   ├── main_window.py       # 메인 윈도우
│   ├── chat_widget.py       # 채팅 위젯
│   ├── document_widget.py   # 문서 관리 위젯
│   ├── settings_widget.py   # 설정 위젯
│   └── components/          # 재사용 컴포넌트
└── resources/               # 리소스 파일 (신규)
    ├── icons/               # 아이콘
    ├── styles/              # 스타일시트
    └── images/              # 이미지
```

### 2. 기술 스택
- **UI 프레임워크**: PySide6 (Qt6)
- **백엔드**: 기존 RAG 시스템 재사용
- **스타일링**: Qt Style Sheets (QSS)
- **아이콘**: Material Design Icons 또는 Feather Icons
- **빌드 도구**: PyInstaller (데스크톱용)

## 🎨 UI/UX 설계

### 1. 메인 윈도우 레이아웃
```
┌─────────────────────────────────────────────────────────┐
│ 🏠 OC_RAG                    ⚙️ 설정  📊 상태  ❌ 종료 │
├─────────────────────────────────────────────────────────┤
│ 📁 문서 관리  │  💬 채팅  │  🔧 설정  │  📈 통계        │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  📄 업로드된 문서 목록                                  │
│  ┌─────────────────────────────────────────────────┐   │
│  │ 📄 document1.pdf (15.6MB)  [🗑️] [👁️] [📊]     │   │
│  │ 📄 document2.pptx (2.1MB)  [🗑️] [👁️] [📊]     │   │
│  │ 📄 document3.xlsx (0.8MB)  [🗑️] [👁️] [📊]     │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  📤 파일 업로드: [파일 선택] [업로드] [간이 문서 작성] │
├─────────────────────────────────────────────────────────┤
│ 💬 채팅 영역                                            │
│ ┌─────────────────────────────────────────────────┐   │
│ │ 사용자: 안녕하세요!                              │   │
│ │ AI: 안녕하세요! 무엇을 도와드릴까요?             │   │
│ │ 사용자: 문서에 대해 질문하고 싶어요              │   │
│ │ AI: 어떤 문서에 대해 질문하시겠습니까?           │   │
│ └─────────────────────────────────────────────────┘   │
│ [질문 입력창] [전송] [🗑️ 대화 초기화]                │
└─────────────────────────────────────────────────────────┘
```

### 2. 주요 UI 컴포넌트

#### A. 메인 윈도우 (`main_window.py`)
- **기능**: 전체 애플리케이션 컨테이너
- **구성**: 탭 위젯으로 문서/채팅/설정 분리
- **특징**: 
  - 다크/라이트 테마 지원
  - 윈도우 크기/위치 기억
  - 시스템 트레이 지원

#### B. 채팅 위젯 (`chat_widget.py`)
- **기능**: 대화 인터페이스
- **구성**: 
  - 메시지 리스트 (스크롤 가능)
  - 입력창 (멀티라인 지원)
  - 전송/초기화 버튼
- **특징**:
  - 실시간 타이핑 표시
  - 메시지 타입별 스타일링
  - 출처 문서 표시

#### C. 문서 관리 위젯 (`document_widget.py`)
- **기능**: 문서 업로드/관리
- **구성**:
  - 문서 목록 (테이블 뷰)
  - 드래그 앤 드롭 지원
  - 문서 미리보기
- **특징**:
  - 파일 타입별 아이콘
  - 문서 통계 표시
  - 벌크 삭제 기능

#### D. 설정 위젯 (`settings_widget.py`)
- **기능**: 애플리케이션 설정
- **구성**:
  - LLM API 설정
  - 임베딩 모델 설정
  - 문서 처리 설정
  - UI 테마 설정
- **특징**:
  - 실시간 설정 적용
  - 설정 검증
  - 기본값 복원

## 🔧 개발 단계

### Phase 1: 기본 구조 설정 (1-2일)
1. **프로젝트 구조 생성**
   - `desktop_app.py` 메인 파일 생성
   - `ui/` 폴더 및 기본 위젯 파일 생성
   - `resources/` 폴더 구조 생성

2. **의존성 추가**
   - `requirements.txt`에 PySide6 추가
   - 기본 아이콘/스타일 리소스 추가

3. **메인 윈도우 구현**
   - 기본 윈도우 생성
   - 탭 레이아웃 구성
   - 메뉴바/툴바 추가

### Phase 2: 핵심 기능 구현 (3-4일)
1. **문서 관리 기능**
   - 파일 업로드 (드래그 앤 드롭)
   - 문서 목록 표시
   - 문서 삭제/미리보기

2. **채팅 기능**
   - 메시지 입력/표시
   - 기존 RAG 체인 연동
   - 대화 이력 관리

3. **설정 기능**
   - LLM API 설정
   - 문서 처리 설정
   - 설정 저장/로드

### Phase 3: UI/UX 개선 (2-3일)
1. **스타일링**
   - 다크/라이트 테마
   - 커스텀 아이콘
   - 애니메이션 효과

2. **사용성 개선**
   - 키보드 단축키
   - 컨텍스트 메뉴
   - 상태 표시

### Phase 4: 고급 기능 (2-3일)
1. **시스템 통합**
   - 시스템 트레이
   - 파일 연결
   - 자동 업데이트

2. **성능 최적화**
   - 비동기 처리
   - 메모리 관리
   - 로딩 표시

### Phase 5: 빌드 및 배포 (1-2일)
1. **PyInstaller 설정**
   - 데스크톱용 spec 파일
   - 아이콘/리소스 포함
   - 의존성 최적화

2. **테스트 및 배포**
   - 기능 테스트
   - 성능 테스트
   - 설치 패키지 생성

## 📦 의존성 관리

### 추가 패키지
```python
# requirements.txt에 추가
PySide6>=6.6.0
PySide6-Addons>=6.6.0
PySide6-Essentials>=6.6.0
```

### 선택적 패키지
```python
# 고급 기능용
qasync>=0.24.0          # 비동기 처리
qtawesome>=1.3.0       # 아이콘
qdarkstyle>=3.2.0      # 다크 테마
```

## 🎯 주요 기능 명세

### 1. 문서 관리
- **파일 업로드**: 드래그 앤 드롭, 파일 선택 다이얼로그
- **지원 형식**: PDF, PPTX, XLSX, TXT
- **문서 정보**: 파일명, 크기, 업로드 시간, 청크 수
- **작업**: 삭제, 미리보기, 통계 보기

### 2. 채팅 인터페이스
- **메시지 표시**: 사용자/AI 메시지 구분
- **출처 표시**: 참조 문서 및 유사도 점수
- **입력 기능**: 멀티라인 텍스트 입력
- **이력 관리**: 대화 저장/로드/초기화

### 3. 설정 관리
- **LLM 설정**: API 타입, 모델, 키, URL
- **임베딩 설정**: 모델, 차원
- **문서 설정**: 청크 크기, 오버랩
- **UI 설정**: 테마, 폰트, 언어

### 4. 시스템 기능
- **시스템 트레이**: 백그라운드 실행
- **파일 연결**: 특정 확장자 파일 더블클릭 실행
- **자동 저장**: 설정 및 대화 이력 자동 저장
- **업데이트**: 자동 업데이트 체크

## 🚀 배포 전략

### 1. 빌드 옵션
- **단일 실행 파일**: `OC_RAG_Desktop.exe`
- **설치 패키지**: NSIS 또는 Inno Setup
- **포터블 버전**: 압축 파일 형태

### 2. 배포 채널
- **GitHub Releases**: 주요 버전 배포
- **직접 배포**: 내부 테스트용
- **자동 업데이트**: 향후 구현

## 📊 성능 목표

### 1. 실행 성능
- **시작 시간**: 3초 이내
- **메모리 사용량**: 500MB 이내
- **CPU 사용률**: 유휴 시 1% 이내

### 2. 사용성
- **응답 시간**: 질문당 5초 이내
- **UI 반응성**: 100ms 이내
- **안정성**: 24시간 연속 실행 가능

## 🔄 마이그레이션 계획

### 1. 코드 재사용
- **백엔드**: 100% 재사용 (utils/ 폴더)
- **설정**: 공통 config.py 사용
- **데이터**: 동일한 데이터 형식 유지

### 2. 호환성
- **설정 파일**: Streamlit과 호환
- **대화 이력**: 동일한 JSON 형식
- **문서 데이터**: 동일한 ChromaDB 형식

## 📝 개발 일정

| 단계 | 기간 | 주요 작업 | 완료 기준 |
|------|------|-----------|-----------|
| Phase 1 | 1-2일 | 기본 구조 설정 | 메인 윈도우 표시 |
| Phase 2 | 3-4일 | 핵심 기능 구현 | 문서 업로드/채팅 작동 |
| Phase 3 | 2-3일 | UI/UX 개선 | 테마/아이콘 적용 |
| Phase 4 | 2-3일 | 고급 기능 | 시스템 트레이/파일 연결 |
| Phase 5 | 1-2일 | 빌드/배포 | 실행 파일 생성 |

**총 예상 기간**: 9-14일

## 🎉 기대 효과

### 1. 사용자 경험
- **빠른 실행**: 브라우저 없이 즉시 실행
- **네이티브 UI**: 시스템과 통합된 인터페이스
- **오프라인 사용**: 인터넷 없이도 로컬 문서 처리

### 2. 개발 효율성
- **코드 재사용**: 기존 백엔드 100% 활용
- **유지보수**: 단일 코드베이스 관리
- **확장성**: 향후 웹 버전과 병행 개발 가능

### 3. 배포 편의성
- **단일 파일**: 복잡한 설치 과정 없음
- **포터블**: USB로 어디서든 실행
- **자동화**: 자동 업데이트 및 설정 동기화

---

이 플랜을 바탕으로 PySide6 데스크톱 버전을 개발하면, 기존 Streamlit 버전의 모든 기능을 유지하면서도 더 나은 사용자 경험을 제공할 수 있습니다.
