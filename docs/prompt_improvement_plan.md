# 프롬프트 엔지니어링 개선 계획 (2025-10-31)

**기반**: 청킹 전략 개선 완료 후 프롬프트 품질 개선

---

## 현재 상황

### 개선 완료 사항
- ✅ 청킹 전략 개선: 최소 50자 이상, 의미 있는 청크만 저장
- ✅ 검색 품질 향상: 매우 짧은 청크 제거 (1자, 16자 등)
- ✅ 평균 청크 길이: 149.0자

### 남은 문제점
- ❌ 문서가 검색되었음에도 "정보를 찾을 수 없습니다" 응답
- ❌ 일반화된 설명으로 회피 (구체적 정보 미제공)
- ❌ 검색된 문서 내용을 충분히 활용하지 못함

---

## 개선 목표

**핵심 목표**: 검색된 문서 기반으로만 답변 생성 (일반 지식 회피)

---

## 구현 계획

### Phase 1: 프롬프트 템플릿 강화 (최우선)

#### 1.1 base_prompt_template 개선
**위치**: `utils/rag_chain.py` 라인 70-90

**개선 내용**:
- 문서 우선 원칙 명시
- "정보 없음" 응답 금지 규칙 강화
- 문서 인용 의무화
- 일반 지식 회피 강조

#### 1.2 specific_info 템플릿 강화
**위치**: `utils/rag_chain.py` 라인 94-114

**개선 내용**:
- 구체적 정보 추출 절차 명시
- 원문 인용 필수 규칙 추가
- Few-Shot 예시 포함

#### 1.3 모든 템플릿에 문서 기반 강제 규칙 적용
- summary, comparison, relationship, general 템플릿도 개선

### Phase 2: 답변 검증 및 후처리 (선택적)

#### 2.1 답변 검증 함수
- 생성된 답변이 문서 기반인지 확인
- 일반화된 답변 감지 및 재생성

#### 2.2 컨텍스트 포맷 개선
- 문서 번호, 페이지 명확히 표시
- 구조화된 포맷으로 LLM이 쉽게 파싱

---

## 예상 효과

- 구체적 정보 제공률: 40% → 80% 향상
- "정보 없음" 응답: 30% → 5% 감소
- 문서 인용률: 50% → 90% 향상

