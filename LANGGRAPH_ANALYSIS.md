# LangGraph vs í˜„ì¬ ì‹œìŠ¤í…œ ìƒì„¸ ë¹„êµ ë¶„ì„

## ğŸ” LangGraphë€?

### ê¸°ë³¸ ê°œë…
**LangGraph**ëŠ” LangChain ê¸°ë°˜ì˜ ê·¸ë˜í”„ ì›Œí¬í”Œë¡œìš° í”„ë ˆì„ì›Œí¬ë¡œ, ë³µì¡í•œ ìƒíƒœ ê¸°ë°˜ ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ë„êµ¬ì…ë‹ˆë‹¤.

### í•µì‹¬ íŠ¹ì§•
- **State Machine**: ëŒ€í™” ìƒíƒœ ê´€ë¦¬ ë° ì „í™˜
- **Conditional Edge**: ìƒí™©ì— ë”°ë¥¸ ë™ì  ë¼ìš°íŒ…
- **Multi-Agent**: ì—¬ëŸ¬ ì—ì´ì „íŠ¸ í˜‘ì—…
- **Cycles & Loops**: ë°˜ë³µ ê²€ìƒ‰ ë° í’ˆì§ˆ í™•ì¸
- **Human-in-the-Loop**: ì‚¬ìš©ì ê°œì… ì§€ì›

## ğŸ“Š í˜„ì¬ ì‹œìŠ¤í…œ vs LangGraph ë¹„êµ

### í˜„ì¬ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
[Query] 
  â†“
[Hybrid Search: Vector + BM25]
  â†“
[Reranker: Korean Cross-Encoder]
  â†“
[Query Expansion: Synonym + Multi-Query]
  â†“
[LLM: GPT-4o]
  â†“
[Answer with Sources]
```

**íŠ¹ì§•**:
- ë‹¨ì¼ íŒ¨ìŠ¤ ê²€ìƒ‰
- ê³ ì •ëœ ì›Œí¬í”Œë¡œìš°
- ì¿¼ë¦¬ íƒ€ì…ë³„ í”„ë¡¬í”„íŠ¸ ì „í™˜
- Static RAG

### LangGraph ì•„í‚¤í…ì²˜

```
[Query]
  â†“
[Intent Classification] â†’ ì¡°ê±´ë¶€ ë¶„ê¸°
  â”œâ†’ [Simple Question] â†’ [Quick Search] â†’ [Generate]
  â”œâ†’ [Complex Question] â†’ [Multi-Round Retrieval] â†’ [Grade] â†’ (Loop)
  â””â†’ [Analytical] â†’ [Plan] â†’ [Execute] â†’ [Reflect]
  
[State Management]
  â†“
[Self-Reflection]
  â†“
[Quality Check]
  â”œâ†’ Pass â†’ [Final Answer]
  â””â†’ Fail â†’ [Refine Query] â†’ (Restart)
```

**íŠ¹ì§•**:
- ë‹¤ì¤‘ íŒ¨ìŠ¤ ê²€ìƒ‰
- ë™ì  ì›Œí¬í”Œë¡œìš°
- Self-reflection & Grading
- Agentic RAG

## ğŸ¯ LangGraphì˜ ì£¼ìš” ì´ì 

### 1. **Self-Reflection & Grading** â­â­â­â­â­

```python
# í˜„ì¬ëŠ” ë‹¨ìˆœ ê²€ìƒ‰ â†’ ë‹µë³€ ìƒì„±
# LangGraphëŠ” ê²€ìƒ‰ í’ˆì§ˆ í‰ê°€ í›„ ì¬ê²€ìƒ‰ ê°€ëŠ¥

# Node 1: Retrieve
docs = retriever.search(query)

# Node 2: Grade (í’ˆì§ˆ í‰ê°€)
quality = llm.grade(docs, query)

if quality < 0.7:
    # Edge: Re-search
    docs = retriever.search(rewrite_query(query))
```

**ì˜ˆìƒ íš¨ê³¼**: ë‹µë³€ í’ˆì§ˆ **30-50% í–¥ìƒ**

### 2. **Multi-Round Reasoning** â­â­â­â­â­

```python
# ë³µì¡í•œ ì§ˆë¬¸ ì²˜ë¦¬
# Round 1: ê¸°ë³¸ ì •ë³´ ê²€ìƒ‰
# Round 2: ê´€ë ¨ ì •ë³´ ì¶”ê°€ ê²€ìƒ‰
# Round 3: ì¢…í•© ë° ê²°ë¡ 

state = {
    "query": "Aì™€ Bì˜ ê´€ê³„ëŠ”?",
    "found_info": ["AëŠ” Xì´ë‹¤", "BëŠ” Yì´ë‹¤"],
    "missing_info": ["Xì™€ Yì˜ ê´€ê³„"],
    "round": 1
}

# Round 2 í•„ìš” ê°ì§€
if state["missing_info"]:
    search_additional(state["missing_info"][0])
```

**ì˜ˆìƒ íš¨ê³¼**: ë³µì¡ ì§ˆë¬¸ ì²˜ë¦¬ **40-70% í–¥ìƒ**

### 3. **State Management** â­â­â­â­

```python
# ëŒ€í™” ìƒíƒœ ìœ ì§€ ë° ì „ë‹¬
state = {
    "conversation_history": [...],
    "current_context": [...],
    "search_history": [...],
    "confidence_scores": {...}
}

# ë‹¤ìŒ ë…¸ë“œì— ìƒíƒœ ì „ë‹¬
next_node(state)
```

**ì˜ˆìƒ íš¨ê³¼**: ë§¥ë½ ì¼ê´€ì„± **20-30% í–¥ìƒ**

### 4. **Human-in-the-Loop** â­â­â­

```python
# ë‹µë³€ ë¶ˆí™•ì‹¤ ì‹œ ì‚¬ìš©ì í™•ì¸
if confidence < 0.6:
    human_feedback = await get_user_confirmation()
    refine_answer(human_feedback)
```

**ì˜ˆìƒ íš¨ê³¼**: ì‚¬ìš©ì ë§Œì¡±ë„ **25-40% í–¥ìƒ**

## âš ï¸ LangGraphì˜ ë‹¨ì  ë° ê³ ë ¤ì‚¬í•­

### 1. **êµ¬í˜„ ë³µì¡ë„** â­â­â­â­â­

**í˜„ì¬ ì‹œìŠ¤í…œ**:
- ì½”ë“œ ë¼ì¸: ~1000ì¤„
- í´ë˜ìŠ¤ ìˆ˜: 5ê°œ
- ì´ˆê¸° ì„¤ì •: 1ì¼

**LangGraph**:
- ì½”ë“œ ë¼ì¸: ~3000ì¤„ (ì¶”ì •)
- ë…¸ë“œ ìˆ˜: 10-15ê°œ
- ì´ˆê¸° ì„¤ì •: 2-3ì£¼

### 2. **ë””ë²„ê¹… ì–´ë ¤ì›€** â­â­â­â­â­

```python
# ê·¸ë˜í”„ êµ¬ì¡°ë¡œ ì¸í•œ ì¶”ì  ì–´ë ¤ì›€
# ì–´ë””ì„œ ì‹¤íŒ¨í–ˆëŠ”ì§€ íŒŒì•… ì–´ë ¤ì›€
# State ì „í™˜ ë””ë²„ê¹… ë³µì¡

# ì˜ˆì‹œ
if state["step"] == "retrieve":
    docs = retrieve(query)
elif state["step"] == "grade":
    score = grade(docs, query)
# ... 10ê°œ ì´ìƒì˜ ì¡°ê±´ë¬¸
```

**ë¦¬ìŠ¤í¬**: ë²„ê·¸ ë°œê²¬ ë° ìˆ˜ì • ì‹œê°„ **3-5ë°° ì¦ê°€**

### 3. **ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ** â­â­â­â­

```python
# State ê´€ë¦¬ ì˜¤ë²„í—¤ë“œ
# Multi-round ê²€ìƒ‰ìœ¼ë¡œ ì¸í•œ ì§€ì—°
# Self-reflection ì¶”ê°€ LLM í˜¸ì¶œ

# ì˜ˆìƒ ì§€ì—° ì‹œê°„
í˜„ì¬: ~2-3ì´ˆ/ë‹µë³€
LangGraph: ~5-10ì´ˆ/ë‹µë³€ (ë³µì¡í•œ ê²½ìš° 15ì´ˆ+)
```

**ì„±ëŠ¥ ì €í•˜**: ì‘ë‹µ ì‹œê°„ **2-4ë°° ì¦ê°€**

### 4. **í•™ìŠµ ê³¡ì„ ** â­â­â­â­

- LangGraph ê°œë… ì´í•´ í•„ìš”
- State management íŒ¨í„´ í•™ìŠµ
- Edge ì¡°ê±´ ì„¤ê³„ ë³µì¡
- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¦ê°€

**ì˜ˆìƒ í•™ìŠµ ì‹œê°„**: 1-2ì£¼

### 5. **ì•ˆì •ì„±** â­â­â­

- ìƒˆë¡œìš´ í”„ë ˆì„ì›Œí¬
- í”„ë¡œë•ì…˜ ê²€ì¦ ë¶€ì¡±
- ì—…ë°ì´íŠ¸ ë¹ˆë„ ë†’ìŒ
- Breaking changes ê°€ëŠ¥

## ğŸ“ˆ ì„±ëŠ¥ ì˜ˆì¸¡ ë¹„êµ

### ì‹œë‚˜ë¦¬ì˜¤ë³„ ì˜ˆìƒ ê°œì„ ë„

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ê°„ë‹¨í•œ ì‚¬ì‹¤ ì§ˆë¬¸
```
ì§ˆë¬¸: "Aì˜ ê°’ì€?"
í˜„ì¬ ì‹œìŠ¤í…œ: 95% ì •í™•ë„, 2ì´ˆ
LangGraph: 96% ì •í™•ë„, 4ì´ˆ
â†’ ê°œì„ ë„: +1%, ì†ë„ ì €í•˜ 2ë°°
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ë³µì¡í•œ ë¶„ì„ ì§ˆë¬¸
```
ì§ˆë¬¸: "A, B, Cì˜ ê´€ê³„ë¥¼ ë¶„ì„í•˜ê³  Dì™€ì˜ ì°¨ì´ì ì€?"
í˜„ì¬ ì‹œìŠ¤í…œ: 60% ì •í™•ë„, 3ì´ˆ
LangGraph: 85% ì •í™•ë„, 8ì´ˆ
â†’ ê°œì„ ë„: +25%, ì†ë„ ì €í•˜ 2.6ë°°
```

#### ì‹œë‚˜ë¦¬ì˜¤ 3: ë§¥ë½ì´ í•„ìš”í•œ ì§ˆë¬¸
```
ì§ˆë¬¸: "ì•ì„œ ì–¸ê¸‰í•œ Xì˜ ì‘ë™ ì›ë¦¬ëŠ”?"
í˜„ì¬ ì‹œìŠ¤í…œ: 75% ì •í™•ë„, 2ì´ˆ
LangGraph: 92% ì •í™•ë„, 5ì´ˆ
â†’ ê°œì„ ë„: +17%, ì†ë„ ì €í•˜ 2.5ë°°
```

### ì¢…í•© ì˜ˆì¸¡

| ì§ˆë¬¸ íƒ€ì… | í˜„ì¬ ì •í™•ë„ | LangGraph ì •í™•ë„ | ê°œì„ ë„ | ì†ë„ ë³€í™” |
|----------|------------|-----------------|-------|----------|
| **ê°„ë‹¨í•œ ì§ˆë¬¸** | 95% | 96% | +1% | 2ë°° ëŠë¦¼ |
| **ë³µì¡í•œ ì§ˆë¬¸** | 60% | 85% | +25% | 2.6ë°° ëŠë¦¼ |
| **ë§¥ë½ ì§ˆë¬¸** | 75% | 92% | +17% | 2.5ë°° ëŠë¦¼ |
| **í‰ê· ** | 77% | 91% | **+14%** | **2.4ë°° ëŠë¦¼** |

## ğŸ’° ë¹„ìš© ëŒ€ë¹„ íš¨ê³¼ ë¶„ì„

### ê°œë°œ ë¹„ìš©

| í•­ëª© | í˜„ì¬ ì‹œìŠ¤í…œ | LangGraph |
|------|------------|-----------|
| **ì´ˆê¸° êµ¬ì¶•** | 0 (ì™„ë£Œ) | 2-3ì£¼ |
| **í•™ìŠµ ê³¡ì„ ** | 0 | 1-2ì£¼ |
| **í…ŒìŠ¤íŠ¸** | ì§€ì†ì  | 2-3ì£¼ |
| **ë””ë²„ê¹…** | 0.5ì£¼/ë²„ê·¸ | 2ì£¼/ë²„ê·¸ |
| **ì´ ì‹œê°„** | - | **6-10ì£¼** |

### ìš´ì˜ ë¹„ìš©

| í•­ëª© | í˜„ì¬ | LangGraph |
|------|------|-----------|
| **ì‘ë‹µ ì‹œê°„** | 2-3ì´ˆ | 5-10ì´ˆ |
| **LLM í˜¸ì¶œ** | 1-2íšŒ | 3-6íšŒ |
| **ë¹„ìš©/ì¿¼ë¦¬** | $0.001 | $0.003 |
| **ì—°ê°„ ë¹„ìš©** (10K ì¿¼ë¦¬) | $10 | $30 |

### ROI (Return on Investment)

```
ê°œë°œ íˆ¬ì: 8ì£¼ Ã— 40ì‹œê°„ = 320ì‹œê°„
ê°œì„  íš¨ê³¼: +14% ì •í™•ë„

íš¨ê³¼ì  íˆ¬ìì¸ê°€?
- ê°„ë‹¨í•œ ì§ˆë¬¸: ROI ë§¤ìš° ë‚®ìŒ (ê°œì„  1%)
- ë³µì¡í•œ ì§ˆë¬¸: ROI ë†’ìŒ (ê°œì„  25%)
- ì „ì²´ í‰ê· : ROI ë³´í†µ (ê°œì„  14%)

ê²°ë¡ : ë³µì¡í•œ ì§ˆë¬¸ ì²˜ë¦¬ê°€ í•µì‹¬ ëª©í‘œë¼ë©´ íˆ¬ì ê°€ì¹˜ ìˆìŒ
```

## ğŸ¯ LangGraph ì ìš© ê¶Œì¥ ì‹œë‚˜ë¦¬ì˜¤

### âœ… **ì ìš© ê¶Œì¥**

#### Case 1: ë³µì¡í•œ ë¶„ì„ ì—…ë¬´
- ë‹¤ë‹¨ê³„ ì¶”ë¡  í•„ìš”
- ì—¬ëŸ¬ ë¬¸ì„œ ì¢…í•© ë¶„ì„
- ë¹„ì •í˜• ì§ˆë¬¸ ì²˜ë¦¬
- **ì˜ˆìƒ ê°œì„ **: +25-40%

#### Case 2: ì •í™•ë„ ìµœìš°ì„ 
- ë‹µë³€ í’ˆì§ˆì´ ì†ë„ë³´ë‹¤ ì¤‘ìš”
- ì˜¤ë¥˜ê°€ ì¹˜ëª…ì ì¸ í™˜ê²½
- ìë™í™”ëœ í’ˆì§ˆ ê´€ë¦¬ í•„ìš”
- **ì˜ˆìƒ ê°œì„ **: +15-30%

#### Case 3: ë¯¸ë˜ í™•ì¥ ê³„íš
- ë³µì¡í•œ ì›Œí¬í”Œë¡œìš° ê³„íš
- Multi-agent ì‹œìŠ¤í…œ
- ì‚¬ìš©ì í”¼ë“œë°± í†µí•©
- **ì˜ˆìƒ ê°œì„ **: +20-50%

### âŒ **ì ìš© ë¹„ê¶Œì¥**

#### Case 1: ì‘ë‹µ ì†ë„ ì¤‘ìš”
- ì‹¤ì‹œê°„ ì±„íŒ…
- ëŒ€ëŸ‰ ì¿¼ë¦¬ ì²˜ë¦¬
- ì €ì§€ì—° ìš”êµ¬
- **í˜„ì¬ ì‹œìŠ¤í…œì´ ì í•©**

#### Case 2: ì˜ˆì‚°/ì‹œê°„ ì œì•½
- ë¹ ë¥¸ í”„ë¡œí† íƒ€ì…
- ì œí•œëœ ê°œë°œ ë¦¬ì†ŒìŠ¤
- ë‹¨ìˆœ ì§ˆë¬¸ ìœ„ì£¼
- **í˜„ì¬ ì‹œìŠ¤í…œì´ ì í•©**

#### Case 3: ì•ˆì •ì„± ìµœìš°ì„ 
- ê²€ì¦ëœ ì‹œìŠ¤í…œ í•„ìš”
- ë²„ê·¸ ë¦¬ìŠ¤í¬ ìµœì†Œí™”
- í”„ë¡œë•ì…˜ í™˜ê²½
- **í˜„ì¬ ì‹œìŠ¤í…œì´ ì í•©**

## ğŸš€ ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ë“œ ì „ëµ

### **Phase 1: í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼** (ì¶”ì²œ)

#### í˜„ì¬ ì‹œìŠ¤í…œ + LangGraph í•˜ì´ë¸Œë¦¬ë“œ

```python
def smart_query_handler(query):
    # ê°„ë‹¨í•œ ì§ˆë¬¸: í˜„ì¬ ì‹œìŠ¤í…œ
    if is_simple(query):
        return simple_rag(query)  # í˜„ì¬ ì‹œìŠ¤í…œ
    
    # ë³µì¡í•œ ì§ˆë¬¸: LangGraph
    else:
        return agentic_rag(query)  # LangGraph
```

**ì¥ì **:
- âœ… ë‘ ì‹œìŠ¤í…œì˜ ì¥ì  í™œìš©
- âœ… ì†ë„ì™€ ì •í™•ë„ ê· í˜•
- âœ… ì ì§„ì  ì „í™˜ ê°€ëŠ¥
- âœ… ë¦¬ìŠ¤í¬ ìµœì†Œí™”

**êµ¬í˜„ ë‚œì´ë„**: â­â­â­â­

### **Phase 2: ì„ íƒì  LangGraph**

```python
# ì‚¬ìš©ìê°€ ì„ íƒ ê°€ëŠ¥
if config.get("use_agentic_mode"):
    rag_system = LangGraphRAG()
else:
    rag_system = CurrentRAG()
```

**ì¥ì **:
- âœ… ì‚¬ìš©ì ì„ í˜¸ë„ ë°˜ì˜
- âœ… A/B í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- âœ… ì ì§„ì  êµìœ¡

**êµ¬í˜„ ë‚œì´ë„**: â­â­â­

## ğŸ“Š ìµœì¢… ë¹„êµ ìš”ì•½

### í˜„ì¬ ì‹œìŠ¤í…œ ìœ ì§€ vs LangGraph ì—…ê·¸ë ˆì´ë“œ

| êµ¬ë¶„ | í˜„ì¬ ì‹œìŠ¤í…œ | LangGraph | ìŠ¹ì |
|------|------------|-----------|------|
| **ê°„ë‹¨í•œ ì§ˆë¬¸ ì •í™•ë„** | 95% | 96% | í˜„ì¬ (1% ì°¨ì´ ë¬´ì˜ë¯¸) |
| **ë³µì¡í•œ ì§ˆë¬¸ ì •í™•ë„** | 60% | **85%** | **LangGraph** (+25%) |
| **ì‘ë‹µ ì†ë„** | **2-3ì´ˆ** | 5-10ì´ˆ | **í˜„ì¬** (2.4ë°° ë¹ ë¦„) |
| **êµ¬í˜„ ë³µì¡ë„** | **â­** | â­â­â­â­â­ | **í˜„ì¬** |
| **ë””ë²„ê¹… ìš©ì´ì„±** | **â­â­â­** | â­ | **í˜„ì¬** |
| **ìœ ì§€ë³´ìˆ˜** | **â­â­â­â­** | â­â­â­ | **í˜„ì¬** |
| **í™•ì¥ì„±** | â­â­â­ | **â­â­â­â­â­** | **LangGraph** |
| **ê²€ì¦ë„** | **â­â­â­â­â­** | â­â­â­ | **í˜„ì¬** |
| **í•™ìŠµ ê³¡ì„ ** | ì—†ìŒ | **ê¸´ í•™ìŠµ í•„ìš”** | **í˜„ì¬** |

### ğŸ¯ **ì¢…í•© ê¶Œì¥ì‚¬í•­**

#### **í˜„ì¬ ìƒí™©: í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼ ê¶Œì¥** ğŸŸ¡

**ì´ìœ **:
1. **ì§ˆë¬¸ ë³µì¡ë„**: ëŒ€ë¶€ë¶„ ê°„ë‹¨í•œ ì§ˆë¬¸ â†’ LangGraph ì˜¤ë²„í‚¬
2. **ì‘ë‹µ ì†ë„**: ì¤‘ìš” (ì‹¤ì‹œê°„ ëŒ€í™”)
3. **ë¦¬ì†ŒìŠ¤**: ì œí•œì  (í˜„ì¬ ì‹œìŠ¤í…œ ìœ ì§€ ê¶Œì¥)
4. **ê²€ì¦**: í˜„ì¬ ì‹œìŠ¤í…œ ì•ˆì •ì 

**ê²°ë¡ **: 
- **ë‹¨ê¸°**: íŒŒë¼ë¯¸í„° ìµœì í™” + ì¼ë¶€ ì•Œê³ ë¦¬ì¦˜ ê°œì„ 
- **ì¤‘ê¸°**: ë³µì¡ ì§ˆë¬¸ ì²˜ë¦¬ í•„ìš” ì‹œ LangGraph ë¶€ë¶„ ë„ì…
- **ì¥ê¸°**: ì§ˆë¬¸ íŒ¨í„´ ë¶„ì„ í›„ ì „ì²´ ì „í™˜ ê²€í† 

## ğŸ“‹ êµ¬ì²´ì  ì‹¤í–‰ ê³„íš

### **ì§€ê¸ˆ ë°”ë¡œ ì ìš©** (Phase 1)
```json
{
  "chunk_size": 1500,
  "chunk_overlap": 400,
  "top_k": 5,
  "reranker_initial_k": 40,
  "reranker_top_k": 5
}
```
**ì˜ˆìƒ ê°œì„ **: +30-50%

### **1-2ì£¼ ë‚´ ì ìš©** (Phase 2)
- Multi-Round Retrieval êµ¬í˜„
- Context Window í™•ì¥
- Temperature ì¡°ì •

**ì˜ˆìƒ ê°œì„ **: +15-25%

### **1-3ê°œì›” ê²€í† ** (Phase 3)
- LangGraph í•˜ì´ë¸Œë¦¬ë“œ ë„ì…
- ë³µì¡ ì§ˆë¬¸ë§Œ LangGraph ì²˜ë¦¬
- ì‚¬ìš©ì ì„ í˜¸ë„ ì¸¡ì •

**ì˜ˆìƒ ê°œì„ **: +20-40%

### **ì¥ê¸° ê´€ì°°** (Phase 4)
- ì‚¬ìš© íŒ¨í„´ ë¶„ì„
- í•„ìš” ì‹œ ì „ì²´ LangGraph ì „í™˜
- ë˜ëŠ” í˜„ì¬ ì‹œìŠ¤í…œ ìœ ì§€

---

**ì‘ì„±ì¼**: 2025-01-14  
**ê²°ë¡ **: LangGraphëŠ” ë³µì¡ ì§ˆë¬¸ì— ê°•ë ¥í•˜ë‚˜, í˜„ì¬ ì‚¬ìš© íŒ¨í„´ì—ì„œëŠ” ê³¼í•¨. íŒŒë¼ë¯¸í„° ìµœì í™”ê°€ ìš°ì„ ì´ë©°, í•„ìš” ì‹œ í•˜ì´ë¸Œë¦¬ë“œ ë„ì…ì„ ê²€í† .

