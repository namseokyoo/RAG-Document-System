================================================================================
Lennart Balkenhol 검색 테스트
================================================================================

[초기화]
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 4자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[VectorStore] 임베딩 모델 차원: 1024
[VectorStore] BM25 인덱스 구축 완료: 7130개 문서
  ✓ VectorStore 초기화
[LLM] 모델 'gemma3:latest' 확인됨
[HybridRetriever] 초기화 완료 (BM25:0.5 / Vector:0.5)
[HybridRetriever] BM25 인덱스 구축 완료: 7130개 문서
  ✓ RAGChain 초기화
  ✓ DB 총 청크: 7,130개

================================================================================
[테스트 1] 벡터 검색: 'Lennart Balkenhol'
================================================================================
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 17자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원

벡터 검색 결과: 10개

1. [OLED_1401.4427v1.pdf] Page 5
   Department of Physics, Chemistry and Biology, Linköping University, S-58183 Linköping,...
   ✗ 'Balkenhol' 없음

2. [OLED_1908.00197v1.pdf] Page 718
   105. Gadisa, A.; Tvingstedt, K.; Admassie, S.; Lindell, L.; Crispin, X.; Andersson, M.R.; Salaneck, W.R.;...
   ✗ 'Balkenhol' 없음

3. [OLED_2011.11445v1.pdf] Page 340
   20. Kim, J.S.; Granström, M.; Friend, R.H.; Johansson, N.; Salaneck, W.; Daik, R.; Feast, W.J.; Cacialli, F. Indium–...
   ✗ 'Balkenhol' 없음

4. [OLED_2102.01479v1.pdf] Page 162
   (56) Bannwarth, C.; Caldeweyher, E.; Ehlert, S.; Hansen, A.; Pracht, P.; Seibert, J.; Spicher, S.; Grimme, S. Extended...
   ✗ 'Balkenhol' 없음

5. [OLED_2302.00044v1.pdf] Page 294
   _[10] S. Reineke, F. Lindner, G. Schwartz, N. Seidler, K. Walzer, B. Lüssem, K. Leo, Nature...
   ✗ 'Balkenhol' 없음

================================================================================
[테스트 2] 키워드 검색: 'Balkenhol' 텍스트 매칭
================================================================================

키워드 매칭 결과: 6개

1. [OLED_2503.13183v2.pdf] Page 1
   Prepared for submission to JCAP TTK-25-08 OLÉ - Online Learning Emulation in Cosmology Sven Günther,a Lennart Balkenhol,b Christian Fidler,a Ali Rida ...

2. [OLED_2503.13183v2.pdf] Page 23
   0.72 0.70 0.68 0.05 0.15 f NEDE h 0.27 0.26 0.25 Ω mdc 0.010 0.005 Ω φ 2.5 2.0 1.5 w3 ∗ 3.8 3.4 3.0 z gol 01 ∗ TriggerCLASS+MontePython TriggerCLASS+M...

3. [OLED_2503.13183v2.pdf] Page 34
   Casas, Jesús Torrado, Andreas Nygaard, Emil Brinch Holm, Steen Hannestad, Will Hand- ley, Thomas Tram, Marco Bonici, Nils Schöneberg and Silvia Galli ...

================================================================================
[테스트 3] RAG Chain 전체 테스트
================================================================================

질문: Lennart Balkenhol 의 논문을 찾아야 오늘의 숙제가 해결돼?

[LLM] 요청 시작: ollama - gemma3:latest
[LLM] 엔드포인트: http://localhost:11434/api/generate
[LLM] 입력 길이: 785자
[LLM] Ollama API 요청 전송 중...
[LLM] 페이로드: {'model': 'gemma3:latest', 'prompt': '다음 질문을 정확하게 분류하세요:\n\n질문: "Lennart Balkenhol 의 논문을 찾아야 오늘의 숙제가 해결돼?"\n\n\n분류 기준:\n1. **simple** (단순 사실 질문)\n   - 특정 값, 숫자, 이름을 묻는 질문\n   - 1-2 문장으로 답변 가능\n   - 예: "kFRET 값은?", "3페이지 요약", "얼마인가?"\n\n2. **normal** (일반 질문)\n   - 설명이 필요한 질문\n   - 2-3 문단 답변 필요\n   - 약간의 모호함 포함 가능\n   - 예: "OLED 효율은?", "작동 원리는?"\n\n3. **complex** (복잡한 질문)\n   - 비교, 분석, 평가 요청\n   - 다중 항목 또는 다중 관점\n   - 긴 답변 필요 (4+ 문단)\n   - 예: "A와 B를 비교", "영향 분석"\n\n4. **exhaustive** (포괄적 질문)\n   - "모든", "전체", "각각" 등의 전수 조사\n   - 리스트/목록 형태 답변\n   - 예: "모든 슬라이드 제목"\n\n추가 분석:\n- ambiguity: 질문의 모호함 정도 (0.0=명확, 1.0=매우 모호)\n- multi_query_helpful: Multi-Query 생성이 도움될까? (true/false)\n\n**JSON 형식으로만 출력** (다른 텍스트 없이):\n{\n    "type": "simple",\n    "confidence": 0.95,\n    "reasoning": "특정 값을 묻는 단순 질문",\n    "ambiguity": 0.1,\n    "multi_query_helpful": false\n}', 'stream': False, 'options': {'temperature': 0.3, 'num_ctx': 2048, 'num_predict': 512}}
[LLM] 응답 상태: 200
[LLM] 응답 성공: 266자
[LLM] 요청 시작: ollama - gemma3:latest
[LLM] 엔드포인트: http://localhost:11434/api/generate
[LLM] 입력 길이: 718자
[LLM] Ollama API 요청 전송 중...
[LLM] 페이로드: {'model': 'gemma3:latest', 'prompt': '다음 질문이 어떤 카테고리의 문서를 필요로 하는지 분석하세요.\n\n**카테고리 정의:**\n- technical: 과학, 기술, 연구, OLED, 디스플레이, 공학, 학술 내용\n- business: 사업, 뉴스, 제품 발표, 마케팅, 시장 분석\n- hr: 인사, 교육, 출결 관리, 직원 관리\n- safety: 안전, 규정, 위험 관리, 보건\n- reference: 일반 참고 자료\n\n**분류 예시:**\n1. 질문: "TADF 재료의 양자 효율은?"\n   카테고리: technical\n\n2. 질문: "LG디스플레이의 신제품 출시일은?"\n   카테고리: business\n\n3. 질문: "출결 시스템 로그인 방법은?"\n   카테고리: hr\n\n4. 질문: "작업장 안전 수칙은?"\n   카테고리: safety\n\n5. 질문: "분자 구조와 성능의 관계는?"\n   카테고리: technical\n\n6. 질문: "HRD-Net 시스템 사용법은?"\n   카테고리: hr\n\n**분석 대상:**\n질문: Lennart Balkenhol 의 논문을 찾아야 오늘의 숙제가 해결돼?\n\n**지시사항:**\n1. 질문의 주제와 의도를 분석하여 가장 적합한 카테고리를 선택하세요\n2. 여러 카테고리가 관련될 수 있으면 모두 나열하세요 (최대 2개)\n3. 응답은 카테고리 이름만 쉼표로 구분하여 출력하세요 (소문자, 추가 설명 없이)\n4. 예: "technical" 또는 "technical,business"\n\n카테고리:', 'stream': False, 'options': {'temperature': 0.3, 'num_ctx': 2048, 'num_predict': 1024}}
[LLM] 응답 상태: 200
[LLM] 응답 성공: 19자
  [OK] 질문 카테고리 감지: technical, reference
[LLM] 요청 시작: ollama - gemma3:latest
[LLM] 엔드포인트: http://localhost:11434/api/generate
[LLM] 입력 길이: 876자
[LLM] Ollama API 요청 전송 중...
[LLM] 페이로드: {'model': 'gemma3:latest', 'prompt': '당신은 RAG 검색 최적화 전문가입니다. 질문 특성을 분석하여 최적의 문서 검색 개수를 결정하세요.\n\n**질문**: "Lennart Balkenhol 의 논문을 찾아야 오늘의 숙제가 해결돼?"\n\n**분석 절차**:\n1단계 [질문 유형 분류]:\n   - 단일 사실 찾기: "무엇", "얼마", "누구", "언제", "어디" (명확한 하나의 답변)\n   - 목록 나열 (소량): "나열", "목록" (10~30개 항목)\n   - 목록 나열 (대량): "모든", "전체", "각각" (30개 이상 항목)\n   - 비교/분석: "차이", "비교", "vs", "대비", "관계" (다각도 분석)\n   - 종합 정보: "요약", "핵심", "개요", "정리" (전체 컨텍스트)\n   - 복합 질문: 여러 유형이 혼합된 경우\n\n2단계 [복잡도 평가]:\n   - 낮음: 단순한 사실 확인 (3-5개)\n   - 중간: 비교/분석, 기본 종합 (10-20개)\n   - 높음: 목록 나열 (소량), 복합 질문 (30-50개)\n   - 매우 높음: 전체 목록 나열, 슬라이드/페이지 전체 (50-100개)\n\n**Few-shot 예시**:\n[예시 1]\n질문: "OLED 효율은 얼마인가?"\n유형: 단일 사실 찾기\n복잡도: 낮음\n추천 개수: 5\n\n[예시 2]\n질문: "논문에서 사용한 재료를 나열해주세요."\n유형: 목록 나열 (소량)\n복잡도: 높음\n추천 개수: 30\n\n[예시 3]\n질문: "모든 슬라이드의 제목을 알려줘."\n유형: 목록 나열 (대량)\n복잡도: 매우 높음\n추천 개수: 80\n\n[예시 4]\n질문: "각 페이지의 주요 내용을 정리해줘."\n유형: 전체 페이지 종합\n복잡도: 매우 높음\n추천 개수: 100\n\n**출력 형식**: 숫자만 출력 (범위: 3-100)\n\n**분석 결과**:', 'stream': False, 'options': {'temperature': 0.3, 'num_ctx': 2048, 'num_predict': 1024}}
[LLM] 응답 상태: 200
[LLM] 응답 성공: 2자
[LLM-TOPK] 동적 top_k 결정: 15 (질문 유형 분석)
[SEARCH] 질문 특성 분석: top_k = 15 (기본: 5)
[Timing] synonym_expand: 0.00s
[SEARCH] 듀얼 DB 검색 모드: integrated, initial_k=30
[VectorStore] 공유 DB 비활성화 - 개인 DB만 검색
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 40자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Timing] candidate_retrieval (fallback): 4.32s (candidates=30)
[Timing] final_rerank (fallback): 2.26s
[STAT] 통계 기반 이상치 제거: 14개 문서 필터링 (MAD 방식)
[SCORE] 동적 Threshold: 3.2864 (top1=5.4773 × 0.6)
[ADAPTIVE] Default mode → max=10
[SCORE] 최대 개수 제한: 5개 제거 (max=10)
[SCORE] Score-based 필터링: 6개 문서 제거 (threshold=3.2864)
       최종 선택: 10개 문서 (점수 범위: 5.4773 ~ 3.9962)
[Timing] score_filtering: 0.00s
[Timing] deduplication: 2.26s (selected=10)
[Timing] context_standard total: 7.80s (mode=fallback, top_k=15)
[Timing] context retrieval (standard, type=general): 29.72s
[LLM] 요청 시작: ollama - gemma3:latest
[LLM] 엔드포인트: http://localhost:11434/api/generate
[LLM] 입력 길이: 785자
[LLM] Ollama API 요청 전송 중...
[LLM] 페이로드: {'model': 'gemma3:latest', 'prompt': '다음 질문을 정확하게 분류하세요:\n\n질문: "Lennart Balkenhol 의 논문을 찾아야 오늘의 숙제가 해결돼?"\n\n\n분류 기준:\n1. **simple** (단순 사실 질문)\n   - 특정 값, 숫자, 이름을 묻는 질문\n   - 1-2 문장으로 답변 가능\n   - 예: "kFRET 값은?", "3페이지 요약", "얼마인가?"\n\n2. **normal** (일반 질문)\n   - 설명이 필요한 질문\n   - 2-3 문단 답변 필요\n   - 약간의 모호함 포함 가능\n   - 예: "OLED 효율은?", "작동 원리는?"\n\n3. **complex** (복잡한 질문)\n   - 비교, 분석, 평가 요청\n   - 다중 항목 또는 다중 관점\n   - 긴 답변 필요 (4+ 문단)\n   - 예: "A와 B를 비교", "영향 분석"\n\n4. **exhaustive** (포괄적 질문)\n   - "모든", "전체", "각각" 등의 전수 조사\n   - 리스트/목록 형태 답변\n   - 예: "모든 슬라이드 제목"\n\n추가 분석:\n- ambiguity: 질문의 모호함 정도 (0.0=명확, 1.0=매우 모호)\n- multi_query_helpful: Multi-Query 생성이 도움될까? (true/false)\n\n**JSON 형식으로만 출력** (다른 텍스트 없이):\n{\n    "type": "simple",\n    "confidence": 0.95,\n    "reasoning": "특정 값을 묻는 단순 질문",\n    "ambiguity": 0.1,\n    "multi_query_helpful": false\n}', 'stream': False, 'options': {'temperature': 0.3, 'num_ctx': 2048, 'num_predict': 1024}}
[LLM] 응답 상태: 200
[LLM] 응답 성공: 263자
[LLM] 요청 시작: ollama - gemma3:latest
[LLM] 엔드포인트: http://localhost:11434/api/generate
[LLM] 입력 길이: 718자
[LLM] Ollama API 요청 전송 중...
[LLM] 페이로드: {'model': 'gemma3:latest', 'prompt': '다음 질문이 어떤 카테고리의 문서를 필요로 하는지 분석하세요.\n\n**카테고리 정의:**\n- technical: 과학, 기술, 연구, OLED, 디스플레이, 공학, 학술 내용\n- business: 사업, 뉴스, 제품 발표, 마케팅, 시장 분석\n- hr: 인사, 교육, 출결 관리, 직원 관리\n- safety: 안전, 규정, 위험 관리, 보건\n- reference: 일반 참고 자료\n\n**분류 예시:**\n1. 질문: "TADF 재료의 양자 효율은?"\n   카테고리: technical\n\n2. 질문: "LG디스플레이의 신제품 출시일은?"\n   카테고리: business\n\n3. 질문: "출결 시스템 로그인 방법은?"\n   카테고리: hr\n\n4. 질문: "작업장 안전 수칙은?"\n   카테고리: safety\n\n5. 질문: "분자 구조와 성능의 관계는?"\n   카테고리: technical\n\n6. 질문: "HRD-Net 시스템 사용법은?"\n   카테고리: hr\n\n**분석 대상:**\n질문: Lennart Balkenhol 의 논문을 찾아야 오늘의 숙제가 해결돼?\n\n**지시사항:**\n1. 질문의 주제와 의도를 분석하여 가장 적합한 카테고리를 선택하세요\n2. 여러 카테고리가 관련될 수 있으면 모두 나열하세요 (최대 2개)\n3. 응답은 카테고리 이름만 쉼표로 구분하여 출력하세요 (소문자, 추가 설명 없이)\n4. 예: "technical" 또는 "technical,business"\n\n카테고리:', 'stream': False, 'options': {'temperature': 0.3, 'num_ctx': 2048, 'num_predict': 1024}}
[LLM] 응답 상태: 200
[LLM] 응답 성공: 19자
  [OK] 질문 카테고리 감지: technical, reference
[LLM] 요청 시작: ollama - gemma3:latest
[LLM] 엔드포인트: http://localhost:11434/api/generate
[LLM] 입력 길이: 876자
[LLM] Ollama API 요청 전송 중...
[LLM] 페이로드: {'model': 'gemma3:latest', 'prompt': '당신은 RAG 검색 최적화 전문가입니다. 질문 특성을 분석하여 최적의 문서 검색 개수를 결정하세요.\n\n**질문**: "Lennart Balkenhol 의 논문을 찾아야 오늘의 숙제가 해결돼?"\n\n**분석 절차**:\n1단계 [질문 유형 분류]:\n   - 단일 사실 찾기: "무엇", "얼마", "누구", "언제", "어디" (명확한 하나의 답변)\n   - 목록 나열 (소량): "나열", "목록" (10~30개 항목)\n   - 목록 나열 (대량): "모든", "전체", "각각" (30개 이상 항목)\n   - 비교/분석: "차이", "비교", "vs", "대비", "관계" (다각도 분석)\n   - 종합 정보: "요약", "핵심", "개요", "정리" (전체 컨텍스트)\n   - 복합 질문: 여러 유형이 혼합된 경우\n\n2단계 [복잡도 평가]:\n   - 낮음: 단순한 사실 확인 (3-5개)\n   - 중간: 비교/분석, 기본 종합 (10-20개)\n   - 높음: 목록 나열 (소량), 복합 질문 (30-50개)\n   - 매우 높음: 전체 목록 나열, 슬라이드/페이지 전체 (50-100개)\n\n**Few-shot 예시**:\n[예시 1]\n질문: "OLED 효율은 얼마인가?"\n유형: 단일 사실 찾기\n복잡도: 낮음\n추천 개수: 5\n\n[예시 2]\n질문: "논문에서 사용한 재료를 나열해주세요."\n유형: 목록 나열 (소량)\n복잡도: 높음\n추천 개수: 30\n\n[예시 3]\n질문: "모든 슬라이드의 제목을 알려줘."\n유형: 목록 나열 (대량)\n복잡도: 매우 높음\n추천 개수: 80\n\n[예시 4]\n질문: "각 페이지의 주요 내용을 정리해줘."\n유형: 전체 페이지 종합\n복잡도: 매우 높음\n추천 개수: 100\n\n**출력 형식**: 숫자만 출력 (범위: 3-100)\n\n**분석 결과**:', 'stream': False, 'options': {'temperature': 0.3, 'num_ctx': 2048, 'num_predict': 1024}}
[LLM] 응답 상태: 200
[LLM] 응답 성공: 2자
[LLM-TOPK] 동적 top_k 결정: 15 (질문 유형 분석)
[SEARCH] 질문 특성 분석: top_k = 15 (기본: 5)
[Timing] synonym_expand: 0.00s
[SEARCH] 듀얼 DB 검색 모드: integrated, initial_k=30
[VectorStore] 공유 DB 비활성화 - 개인 DB만 검색
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 40자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Timing] candidate_retrieval (fallback): 4.12s (candidates=30)
[Timing] final_rerank (fallback): 2.40s
[STAT] 통계 기반 이상치 제거: 14개 문서 필터링 (MAD 방식)
[SCORE] 동적 Threshold: 3.2864 (top1=5.4773 × 0.6)
[ADAPTIVE] Default mode → max=10
[SCORE] 최대 개수 제한: 5개 제거 (max=10)
[SCORE] Score-based 필터링: 6개 문서 제거 (threshold=3.2864)
       최종 선택: 10개 문서 (점수 범위: 5.4773 ~ 3.9962)
[Timing] score_filtering: 0.00s
[Timing] deduplication: 2.40s (selected=10)
[Timing] context_standard total: 7.73s (mode=fallback, top_k=15)
[Timing] context retrieval (standard, type=general): 22.92s
[LLM] 요청 시작: ollama - gemma3:latest
[LLM] 엔드포인트: http://localhost:11434/api/generate
[LLM] 입력 길이: 4591자
[LLM] Ollama API 요청 전송 중...
[LLM] 페이로드: {'model': 'gemma3:latest', 'prompt': '당신은 문서 기반 AI 어시스턴트입니다. 제공된 문서를 바탕으로 정확하고 유용한 답변을 제공하세요.\n\n제공된 문서:\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #1\n   파일명: ESTA_유남석.pdf\n   페이지: 23\n   청크 타입: paragraph\n   섹션: 하거나 체류한 적이 있습니까?\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n문서감축법: 최근의 유효한 OMB 제어 번호와 만료일이 표시되지 않으면 기관은 정보 수집을 진행하거나 지원할 수 없으며 이러한 정보\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #2\n   파일명: HRD-Net_출결관리_업무매뉴얼.pdf\n   페이지: 5\n   청크 타입: page_summary\n   섹션: 문서 서두\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\nHRD-Net 출결관리앱 사용자 매뉴얼(훈련생용) 7 8 HRD-Net 출결관리앱 사용자 매뉴얼(훈련생용)\n○ 회원가입 정보 입력 후 저장을 합니다.\n○ 로그인 후 회원정보관리에서 실명확인(본인확인)을 실행합니다.\n○ 회원가입 완료에서 아이디를 확인합니다.\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #3\n   파일명: ESTA_유남석.pdf\n   페이지: 24\n   청크 타입: paragraph\n   섹션: 하거나 체류한 적이 있습니까?\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n에는 응답할 의무가 없습니다. 본 정보 수집 문서의 제어 번호는 1651-0111입니다. 본 신청서를 작성하는 데 필요한 예상시간은 평균\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #4\n   파일명: HF_OLED_Nature_Photonics_2024_20251027130521.pptx\n   페이지: 2\n   청크 타입: bullet_group\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n형광 에미터: 고효율 단일항 발광(빠른 감쇠, 색순도) *FRET 에너지 전달 효율(ηFRET)이 핵심 성능 결정 인자\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #5\n   파일명: ESTA_유남석.pdf\n   페이지: 17\n   청크 타입: paragraph\n   섹션: 3) 불법 약물의 소지, 사용 또는 분배와 관련된 법을 위반한 적이 있습니까?아니요\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n4) 테러리스트 활동, 첩보 활동, 사보타주 혹은 집단학살에 연루된 적이 있거나 연루되려 하십니까?아니요\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #6\n   파일명: HF_OLED_Nature_Photonics_2024_20251027130521.pptx\n   페이지: 7\n   청크 타입: bullet_group\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n패러다임 전환: TADF 자체 성능과 HF 센서타이징 성능은 상반되는 요구사항을 가짐 - 기존 TADF 재료 재평가 필요\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #7\n   파일명: ESTA_유남석.pdf\n   페이지: 7\n   청크 타입: paragraph\n   섹션: 그 외 다른 이름이나 가명을 사용하십니까? \xa0 아니요\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n귀하는 여행을 위해 그 외 다른 국가에서 여권이나 주민등록증을 발급받은 적이 있습니까? \xa0 아니요\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #8\n   파일명: ESTA_유남석.pdf\n   페이지: 4\n   청크 타입: paragraph\n   섹션: 닫기\xa0출력\xa0다운로드\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n은 아닙니다. 입국장의 Customs and Border Protection (CBP) 직원이 입국 여부에 대한 최종 결정을 내립니다.\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #9\n   파일명: ESTA_유남석.pdf\n   페이지: 20\n   청크 타입: paragraph\n   섹션: 하신 적이 있습니까?\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n7) 귀하의 현재 혹은 이전 여권과 관련하여 예전에 미국 비자 혹은 미국 입국을 거부당하거나 미국 입국장에서\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #10\n   파일명: HRD-Net_출결관리_업무매뉴얼.pdf\n   페이지: 1\n   청크 타입: page_summary\n   섹션: 문서 서두\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n목 차\nHRD-Net 출결관리앱\n사용자 매뉴얼(훈련생용)\n1. 개요···································································································3\n2. 애플리케이션을 이용한 출결관리 프로세스·····························3\n3. 애플리케이션 설치가이드(안드로이드)·······································3\n4. HRD-Net 회원가입 및 본인확인·················································7\n5. 출결관리 앱 사용법(기본)···························································11\n6. 출결관리 앱 사용법(부가기능)···················································13\n7. 휴대전화설정·················································································14\n\n이전 대화:\n이전 대화 없음\n\n질문:\nLennart Balkenhol 의 논문을 찾아야 오늘의 숙제가 해결돼?\n\n---\n\n답변 가이드:\n\n1. **자연스러운 형식**:\n   - 섹션 제목 없이 자연스러운 문단으로 작성\n   - 질문이 간단하면 짧게 (1-2문장), 복잡하면 여러 문단으로\n   - 사용자 의도에 맞게 답변 (번역/요약/설명 등)\n   - **수식, 수치, 기호가 있으면 반드시 원문 그대로 정확히 추출하여 포함** (예: R ~ t^(1/3), Pe_C = χ_0 / M_0)\n\n2. **Inline Citation** (필수):\n   - 모든 사실에 [번호] 표시\n   - 예시: "kFRET 값은 87.8%입니다[1]."\n   - 여러 출처: "TADF를 활용하며[1], 높은 효율을 보입니다[2]."\n\n3. **예시**:\n\n질문: "kFRET 값은?"\n답변: 제공된 문서에 따르면, kFRET 값은 약 87.8%입니다[1]. 이는 형광 도펀트와 호스트 간의 에너지 전달 효율을 나타냅니다[1].\n\n질문: "TADF란 무엇인가?"\n답변: TADF(Thermally Activated Delayed Fluorescence)는 삼중항 여기자를 열적으로 활성화하여 일중항으로 재변환하는 발광 메커니즘입니다[1]. 이를 통해 OLED에서 이론적으로 100%의 내부 양자 효율을 달성할 수 있습니다[1][2].\n\n질문: "서론 번역해줘"\n답변: 하이브리드 형광 OLED는 TADF 보조 호스트와 형광 도펀트를 결합한 새로운 아키텍처입니다[1]. 이 접근법은 TADF의 높은 효율과 형광 도펀트의 우수한 색순도를 동시에 달성합니다[1][2].\n\n질문: "Pe_C는 무엇을 나타내나?"\n답변: 화학주성 Péclet 수(Pe_C)는 방향성 있는 화학주성과 방향성 없는 활성 확산 사이의 경쟁을 나타냅니다[1]. Pe_C ≡ χ_0 / M_0로 정의됩니다[1].\n\n질문: "합성 온도는?"\n답변: 문서에서는 유기 합성 과정을 설명하고 있지만[1], 구체적인 합성 온도는 명시되어 있지 않습니다.\n\n4. **중요**:\n   - 문서에 근거하지 않은 추측은 하지 마세요. 문서의 내용만을 바탕으로 답변하세요.\n   - 수학 공식, 부등식, 관계식이 있으면 반드시 정확히 인용하세요.\n\n답변:', 'stream': False, 'options': {'temperature': 0.3, 'num_ctx': 2048, 'num_predict': 1024}}
[LLM] 응답 상태: 200
[LLM] 응답 성공: 225자
[WARN] 답변 검증 실패: 금지 구문 사용, 문서 내용과 불일치
[INFO] 문서 기반 재생성 시도...
[LLM] 요청 시작: ollama - gemma3:latest
[LLM] 엔드포인트: http://localhost:11434/api/generate
[LLM] 입력 길이: 2039자
[LLM] Ollama API 요청 전송 중...
[LLM] 페이로드: {'model': 'gemma3:latest', 'prompt': '이전에 생성된 답변이 문서 기반이 아니었습니다. 제공된 문서만을 사용하여 다시 답변하세요.\n\n⚠️ 중요 규칙:\n1. **문서 우선**: 반드시 제공된 문서에서만 정보를 찾으세요\n2. **금지 구문**: "정보를 찾을 수 없습니다", "없습니다"는 절대 사용하지 마세요\n3. **문서 인용**: 반드시 문서의 내용을 인용하고 페이지/파일 정보를 명시하세요\n4. **구체성**: 문서의 구체적인 수치, 이름, 내용을 정확히 인용하세요\n\n이전 대화:\n이전 대화 없음\n\n제공된 문서:\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #1\n   파일명: ESTA_유남석.pdf\n   페이지: 23\n   청크 타입: paragraph\n   섹션: 하거나 체류한 적이 있습니까?\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n문서감축법: 최근의 유효한 OMB 제어 번호와 만료일이 표시되지 않으면 기관은 정보 수집을 진행하거나 지원할 수 없으며 이러한 정보\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #2\n   파일명: HRD-Net_출결관리_업무매뉴얼.pdf\n   페이지: 5\n   청크 타입: page_summary\n   섹션: 문서 서두\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\nHRD-Net 출결관리앱 사용자 매뉴얼(훈련생용) 7 8 HRD-Net 출결관리앱 사용자 매뉴얼(훈련생용)\n○ 회원가입 정보 입력 후 저장을 합니다.\n○ 로그인 후 회원정보관리에서 실명확인(본인확인)을 실행합니다.\n○ 회원가입 완료에서 아이디를 확인합니다.\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #3\n   파일명: ESTA_유남석.pdf\n   페이지: 24\n   청크 타입: paragraph\n   섹션: 하거나 체류한 적이 있습니까?\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n에는 응답할 의무가 없습니다. 본 정보 수집 문서의 제어 번호는 1651-0111입니다. 본 신청서를 작성하는 데 필요한 예상시간은 평균\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #4\n   파일명: HF_OLED_Nature_Photonics_2024_20251027130521.pptx\n   페이지: 2\n   청크 타입: bullet_group\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n형광 에미터: 고효율 단일항 발광(빠른 감쇠, 색순도) *FRET 에너지 전달 효율(ηFRET)이 핵심 성능 결정 인자\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n📄 문서 #5\n   파일명: ESTA_유남석.pdf\n   페이지: 17\n   청크 타입: paragraph\n   섹션: 3) 불법 약물의 소지, 사용 또는 분배와 관련된 법을 위반한 적이 있습니까?아니요\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\n4) 테러리스트 활동, 첩보 활동, 사보타주 혹은 집단학살에 연루된 적이 있거나 연루되려 하십니까?아니요\n\n질문:\nLennart Balkenhol 의 논문을 찾아야 오늘의 숙제가 해결돼?\n\n이전 답변 (참고용, 개선 필요):\n제공된 문서에 따르면 Lennart Balkenhol의 논문을 찾는 데 직접적인 정보는 없습니다. 문서들은 주로 출입국 관련 절차, 개인 정보 수집, HRD-Net 출결관리 앱 사용법에 대한 내용입니다. 특히, 논문 검색과 관련된 정보는 찾을 수 없습니다.\n\n다만, HRD-Net 출결관리 앱 사용법(훈련생용) 문서(페이지 7)를 참고하면 회원가입 및 본인 확인 절차를 통해 앱을 이용할 수 있습니다.\n\n\n위 이전 답변을 개선하여, 제공된 문서에 근거한 구체적이고 명확한 답변을 작성하세요.\n\n답변:', 'stream': False, 'options': {'temperature': 0.3, 'num_ctx': 2048, 'num_predict': 1024}}
[LLM] 응답 상태: 200
[LLM] 응답 성공: 174자
[OK] 답변 재생성 완료
  [CITE] Citation 생성 중... (문서 5개)
    [OK] 문장 분리: 3개
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 50자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 73자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 143자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 76자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 66자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 58자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 63자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 73자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 143자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 76자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 66자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 58자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 59자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 73자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 143자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 76자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 66자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 58자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원
    [OK] Citation 추가: 3/3개 문장
[응답]
제공된 문서에는 Lennart Balkenhol의 논문을 찾는 데 필요한 정보가 없습니다. [ESTA_유남석, p.17][ESTA_유남석, p.23] 문서 #3에 따르면, 본 신청서의 제어 번호는 1651-0111이며, 예상되는 시간은 평균입니다 (페이지 24). [ESTA_유남석, p.24][ESTA_유남석, p.23] HRD-Net 출결관리 앱 사용법(훈련생용) 문서(페이지 7)를 통해 앱 사용 방법을 확인할 수 있습니다. [HRD-Net_출결관리_업무매뉴얼, p.5][ESTA_유남석, p.17]

[검색된 문서] 0개

================================================================================
[테스트 4] 단순 이름 검색: 'Balkenhol'
================================================================================
[Embeddings] 요청 모델: mxbai-embed-large:latest
[Embeddings] 엔드포인트: http://localhost:11434/api/embeddings
[Embeddings] 텍스트 길이: 9자
[Embeddings] 응답 상태: 200
[Embeddings] 임베딩 성공: 1024차원

벡터 검색 결과: 10개

→ Top 5 중 0개 문서에서 'Balkenhol' 발견

================================================================================
테스트 완료!
================================================================================

[분석]
1. 키워드 검색: 6개 청크에 'Balkenhol' 포함
2. 벡터 검색: Top-5 문서에서 'Balkenhol' 발견 여부 확인
3. RAG Chain: 최종 답변에서 'Balkenhol' 관련 정보 제공 여부

→ 벡터 검색이 관련 문서를 찾지 못한다면: 임베딩 모델 이슈
→ 벡터 검색은 되지만 답변이 이상하다면: LLM 처리 이슈
